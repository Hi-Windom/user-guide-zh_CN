## B/S 风格

思源笔记整体上采用前后端分离的技术架构，通过 HTTP 实现前后端通讯。

### 前端

前端目前主要是基于浏览器技术，实现用户交互界面和操作系统平台相关的业务逻辑等。

* Electron
* 浏览器

### 后端

后端是常驻内存的 HTTP 服务器，实现核心业务逻辑和状态持久化等。监听端口：

* `6806`：HTTP/WebSocket，在所有网卡（`0.0.0.0`）上监听该端口，`/siyuan/` 路径下的流量会被自动转发到本地端口 `127.0.0.1:6807`
* `6807`：HTTP/WebDAV，在 `127.0.0.1` 监听该端口

## 数据状态

* 持久化数据基于操作系统的文件系统实现，以文件、文件夹存放
* 文档树常驻内核进程内存 #TODO#：优化内存占用
* 只读数据存储于 SQLite 数据库
  * 编辑变更会自动同步到该数据库
  * 数据库临时创建，只在内核运行时存在

## 发布包

* 桌面应用：基于 Electron 打包，主进程启动后拉起 kernel 内核进程。由 kernel  HTTP 伺服界面相关静态资源，Electron 主窗口通过 `loadURL` 加载界面
* 服务器应用：仅打包 kernel 内核和外观、文档等资源，通过 Docker 镜像 `b3log/siyuan` 分发


{: id="20201004190517-2se299k" type="doc"}
